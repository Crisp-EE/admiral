!function(o,e,i){o.fn.modalBox=function(o,e){return n[o]?n[o].call(this,e):"object"!=typeof o&&o||n.open.call(this,o),this},o.modalBox={},o.modalBox.defaults={width:"auto",height:"auto",left:"auto",top:"auto",overlay:!0,iconClose:!1,keyClose:!0,bodyClose:!0,iconImg:"image/closeIcon.png",onOpen:function(){},onClose:function(){}},o.modalBox.close=function(){o(".iw-modalBox").each(function(){n.close.call(o(this))})};var t=function(e){var i=e.keyCode;27==i&&o.modalBox.close()},a=function(e){e.data?n.close.call(e.data.modalBox):o.modalBox.close()},l=function(i){var t=i.data.img,a=i.data.elm;t.css({top:a.offset().top-o(e).scrollTop()-8+"px",left:a.offset().left-o(e).scrollLeft()+a.width()-8+"px",position:"fixed","z-index":"99999"})},d=function(){o("body").append('<div class="iw-modalOverlay"></div>'),o(".iw-modalOverlay").css({display:"block",width:"100%",height:"100%",position:"fixed",top:0,left:0,"z-index":"1000"})},n={open:function(n){n=o.extend({},o.modalBox.defaults,n);var s=this,c=s.width(),h=s.height(),r=s.outerWidth(),m=s.outerHeight(),u=o(e).width(),f=o(e).height(),w=Math.min(r,u)-(r-c),g=Math.min(m,f)-(m-h);s.data("iw-size",{width:c,height:h}).addClass("iw-modalBox"),"auto"!=n.width?s.css("width",n.width):s.width(w),"auto"!=n.height?s.css("height",n.height):s.height(g);var p="50%",x="50%",v=s.outerWidth()/2,y=s.outerHeight()/2;if("auto"!=n.left&&(x=n.left,v="0"),"auto"!=n.top&&(p=n.top,y="0"),s.css({top:p,left:x,position:"fixed",display:"block","margin-left":-v,"margin-top":-y,"z-index":"99999"}),n.overlay&&d(),n.iconClose&&s.outerWidth()<u-50&&s.outerHeight()<f-50){var B=Math.ceil(1e3*Math.random())+"close",b=o('<img src="'+n.iconImg+'" class="iw-closeImg" id="'+B+'"/>');s.attr("closeImg",B),b.bind("click",{modalBox:s},a),o(e).bind("resize.iw-modalBox",{img:b,elm:s},l),o(e).triggerHandler("resize.iw-modalBox"),o("body").append(b)}if(n.keyClose&&o(i).bind("keyup.iw-modalBox",t),n.bodyClose){var C=o(".iw-modalOverlay");0===C.length&&(d(),C=o(".iw-modalOverlay"),C.css({background:"none"})),C.bind("click",a)}n.onOpen.call(this),s.data("closeFun",n.onClose)},close:function(){var t=this;if(t.data("iw-size")){var a=t.attr("closeImg");a&&(t.removeAttr("closeImg"),o("#"+a).remove()),t.css({display:"none"});var l=t.data("iw-size");t.width(l.width),t.height(l.height),t.data("closeFun").call(this),t.removeData("iw-size").removeData("closeFun").removeClass("iw-modalBox"),0===o(".iw-modalBox").length&&(o(".iw-modalOverlay").remove(),o(i).unbind("keyup.iw-modalBox"),o(e).unbind("resize.iw-modalBox"))}}}}(jQuery,window,document);